BEGIN
    EXECUTE IMMEDIATE 'DROP MATERIALIZED VIEW ECKERNEL_USA.MV_WELL_DEFERMENT_CHILD';
EXCEPTION
    WHEN OTHERS THEN NULL;
END;
CREATE MATERIALIZED VIEW ECKERNEL_USA.MV_WELL_DEFERMENT_CHILD 
(
   MV_RFRSH_DATE,
   
   OBJECT_ID,
   OBJECT_CODE,
   OBJECT_NAME,
   PRIOR_EVENT_NO,
   ASG_WATER_VALUE,
   ASG_WATER_TYPE,
   ASG_WATER_INJ_VALUE,
   ASG_WATER_INJ_TYPE,
   ASG_STEAM_INJ_VALUE,
   ASG_STEAM_INJ_TYPE,
   ASG_OIL_VALUE,
   PRIOR_REASON_CODES,
   ASG_COND_TYPE,
   ASG_COND_VALUE,
   ASG_GAS_INJ_TYPE,
   ASG_GAS_INJ_VALUE,
   ASG_GAS_TYPE,
   ASG_GAS_VALUE,
   ASG_OIL_TYPE,
   EVENT_NO,
   DAYTIME,
   END_DATE,
   DOWNTIME_DURATION, DOWNTIME_DURATION_UOM,
   WELL_TYPE, 
   OBJECT_TYPE, 
   EVENT_TYPE,
   DEFERMENT_TYPE,
   ACTIVE_PHASES,
   PARENT_OBJECT_ID,
   PARENT_DAYTIME,
   PARENT_EVENT_NO,
   OIL_POTENTIAL, OIL_POTENTIAL_UOM,
   GAS_POTENTIAL, GAS_POTENTIAL_UOM,
   COND_POTENTIAL, COND_POTENTIAL_UOM,
   WATER_POTENTIAL, WATER_POTENTIAL_UOM,
   WATER_INJ_POTENTIAL, WATER_INJ_POTENTIAL_UOM,
   STEAM_INJ_POTENTIAL, STEAM_INJ_POTENTIAL_UOM,
   GAS_INJ_POTENTIAL, GAS_INJ_POTENTIAL_UOM,
   DILUENT_POTENTIAL, DILUENT_POTENTIAL_UOM,
   GAS_LIFT_POTENTIAL, GAS_LIFT_POTENTIAL_UOM,
   OIL_LOSS_RATE, OIL_LOSS_RATE_UOM,
   GAS_LOSS_RATE, GAS_LOSS_RATE_UOM,
   COND_LOSS_RATE, COND_LOSS_RATE_UOM,
   WATER_LOSS_RATE, WATER_LOSS_RATE_UOM,
   WATER_INJ_LOSS_RATE, WATER_INJ_LOSS_RATE_UOM,
   STEAM_INJ_LOSS_RATE, STEAM_INJ_LOSS_RATE_UOM,
   GAS_INJ_LOSS_RATE, GAS_INJ_LOSS_RATE_UOM,
   DILUENT_LOSS_RATE, DILUENT_LOSS_RATE_UOM,
   GAS_LIFT_LOSS_RATE, GAS_LIFT_LOSS_RATE_UOM,
   OIL_LOSS_VOLUME, OIL_LOSS_VOLUME_UOM,
   GAS_LOSS_VOLUME, GAS_LOSS_VOLUME_UOM,
   COND_LOSS_VOLUME, COND_LOSS_VOLUME_UOM,
   WATER_LOSS_VOLUME, WATER_LOSS_VOLUME_UOM,
   WATER_INJ_LOSS_VOLUME, WATER_INJ_LOSS_VOLUME_UOM,
   STEAM_INJ_LOSS_VOLUME, STEAM_INJ_LOSS_VOLUME_UOM,
   GAS_INJ_LOSS_VOLUME, GAS_INJ_LOSS_VOLUME_UOM,
   DILUENT_LOSS_VOLUME, DILUENT_LOSS_VOLUME_UOM,
   GAS_LIFT_LOSS_VOLUME, GAS_LIFT_LOSS_VOLUME_UOM,
   OIL_EVENT_LOSS, OIL_EVENT_LOSS_UOM,
   GAS_EVENT_LOSS, GAS_EVENT_LOSS_UOM,
   COND_EVENT_LOSS, COND_EVENT_LOSS_UOM,
   WATER_EVENT_LOSS, WATER_EVENT_LOSS_UOM,
   WATER_INJ_EVENT_LOSS, WATER_INJ_EVENT_LOSS_UOM,
   STEAM_INJ_EVENT_LOSS, STEAM_INJ_EVENT_LOSS_UOM,
   GAS_INJ_EVENT_LOSS, GAS_INJ_EVENT_LOSS_UOM,
   DILUENT_EVENT_LOSS, DILUENT_EVENT_LOSS_UOM,
   GAS_LIFT_EVENT_LOSS, GAS_LIFT_EVENT_LOSS_UOM,
   COMMENTS,
   CLASS_NAME,
   PRODUCTION_DAY,
   RECORD_STATUS,
   CREATED_BY,
   CREATED_DATE,
   LAST_UPDATED_BY,
   LAST_UPDATED_DATE,
   REV_NO,
   REV_TEXT,
   REV_EVENT,
   APPROVAL_STATE,
   APPROVAL_BY,
   APPROVAL_DATE,
   REC_ID
)
TABLESPACE DATA01
PCTUSED    0
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOCACHE
NOLOGGING
NOCOMPRESS
NOPARALLEL
BUILD DEFERRED
REFRESH FORCE ON DEMAND
WITH PRIMARY KEY
AS 
/* Formatted on 06/Apr/23 9:37:08 AM (QP5 v5.227.12220.39724) */
WITH UOM
     AS (SELECT CLASS_NAME, ATTRIBUTE_NAME, UNIT
           FROM Z_UOM
          WHERE ATTRIBUTE_NAME IN
                   ('DOWNTIME_DURATION',
                    'OIL_POTENTIAL',
                    'GAS_POTENTIAL',
                    'COND_POTENTIAL',
                    'WATER_POTENTIAL',
                    'WATER_INJ_POTENTIAL',
                    'STEAM_INJ_POTENTIAL',
                    'GAS_INJ_POTENTIAL',
                    'DILUENT_POTENTIAL',
                    'GAS_LIFT_POTENTIAL',
                    'OIL_LOSS_RATE',
                    'GAS_LOSS_RATE',
                    'COND_LOSS_RATE',
                    'WATER_LOSS_RATE',
                    'WATER_INJ_LOSS_RATE',
                    'STEAM_INJ_LOSS_RATE',
                    'GAS_INJ_LOSS_RATE',
                    'DILUENT_LOSS_RATE',
                    'GAS_LIFT_LOSS_RATE',
                    'OIL_LOSS_VOLUME',
                    'GAS_LOSS_VOLUME',
                    'COND_LOSS_VOLUME',
                    'WATER_LOSS_VOLUME',
                    'WATER_INJ_LOSS_VOLUME',
                    'STEAM_INJ_LOSS_VOLUME',
                    'GAS_INJ_LOSS_VOLUME',
                    'DILUENT_LOSS_VOLUME',
                    'GAS_LIFT_LOSS_VOLUME',
                    'OIL_EVENT_LOSS',
                    'GAS_EVENT_LOSS',
                    'COND_EVENT_LOSS',
                    'WATER_EVENT_LOSS',
                    'WATER_INJ_EVENT_LOSS',
                    'STEAM_INJ_EVENT_LOSS',
                    'GAS_INJ_EVENT_LOSS',
                    'DILUENT_EVENT_LOSS',
                    'GAS_LIFT_EVENT_LOSS'))
SELECT SYSDATE AS MV_RFRSH_DATE,
   
   A.OBJECT_ID,
   A.OBJECT_CODE,
   A.OBJECT_NAME,
   A.PRIOR_EVENT_NO,
   A.ASG_WATER_VALUE,
   A.ASG_WATER_TYPE,
   A.ASG_WATER_INJ_VALUE,
   A.ASG_WATER_INJ_TYPE,
   A.ASG_STEAM_INJ_VALUE,
   A.ASG_STEAM_INJ_TYPE,
   A.ASG_OIL_VALUE,
   A.PRIOR_REASON_CODES,
   A.ASG_COND_TYPE,
   A.ASG_COND_VALUE,
   A.ASG_GAS_INJ_TYPE,
   A.ASG_GAS_INJ_VALUE,
   A.ASG_GAS_TYPE,
   A.ASG_GAS_VALUE,
   A.ASG_OIL_TYPE,
   A.EVENT_NO,
   A.DAYTIME,
   A.END_DATE,
   A.DOWNTIME_DURATION, B.UNIT AS DOWNTIME_DURATION_UOM,
   A.WELL_TYPE, 
   A.OBJECT_TYPE, 
   A.EVENT_TYPE,
   A.DEFERMENT_TYPE,
   A.ACTIVE_PHASES,
   A.PARENT_OBJECT_ID,
   A.PARENT_DAYTIME,
   A.PARENT_EVENT_NO,
   A.OIL_POTENTIAL, C.UNIT AS OIL_POTENTIAL_UOM,
   A.GAS_POTENTIAL, D.UNIT AS GAS_POTENTIAL_UOM,
   A.COND_POTENTIAL, E.UNIT AS COND_POTENTIAL_UOM,
   A.WATER_POTENTIAL, F.UNIT AS WATER_POTENTIAL_UOM,
   A.WATER_INJ_POTENTIAL, G.UNIT AS WATER_INJ_POTENTIAL_UOM,
   A.STEAM_INJ_POTENTIAL, H.UNIT AS STEAM_INJ_POTENTIAL_UOM,
   A.GAS_INJ_POTENTIAL, I.UNIT AS GAS_INJ_POTENTIAL_UOM,
   A.DILUENT_POTENTIAL, J.UNIT AS DILUENT_POTENTIAL_UOM,
   A.GAS_LIFT_POTENTIAL, K.UNIT AS GAS_LIFT_POTENTIAL_UOM,
   A.OIL_LOSS_RATE, L.UNIT AS OIL_LOSS_RATE_UOM,
   A.GAS_LOSS_RATE, M.UNIT AS GAS_LOSS_RATE_UOM,
   A.COND_LOSS_RATE, N.UNIT AS COND_LOSS_RATE_UOM,
   A.WATER_LOSS_RATE, O.UNIT AS WATER_LOSS_RATE_UOM,
   A.WATER_INJ_LOSS_RATE, P.UNIT AS WATER_INJ_LOSS_RATE_UOM,
   A.STEAM_INJ_LOSS_RATE, Q.UNIT AS STEAM_INJ_LOSS_RATE_UOM,
   A.GAS_INJ_LOSS_RATE, R.UNIT AS GAS_INJ_LOSS_RATE_UOM,
   A.DILUENT_LOSS_RATE, S.UNIT AS DILUENT_LOSS_RATE_UOM,
   A.GAS_LIFT_LOSS_RATE, T.UNIT AS GAS_LIFT_LOSS_RATE_UOM,
   A.OIL_LOSS_VOLUME, U.UNIT AS OIL_LOSS_VOLUME_UOM,
   A.GAS_LOSS_VOLUME, V.UNIT AS GAS_LOSS_VOLUME_UOM,
   A.COND_LOSS_VOLUME, W.UNIT AS COND_LOSS_VOLUME_UOM,
   A.WATER_LOSS_VOLUME, X.UNIT AS WATER_LOSS_VOLUME_UOM,
   A.WATER_INJ_LOSS_VOLUME, Y.UNIT AS WATER_INJ_LOSS_VOLUME_UOM,
   A.STEAM_INJ_LOSS_VOLUME, Z.UNIT AS STEAM_INJ_LOSS_VOLUME_UOM,
   A.GAS_INJ_LOSS_VOLUME, BA.UNIT AS GAS_INJ_LOSS_VOLUME_UOM,
   A.DILUENT_LOSS_VOLUME, BB.UNIT AS DILUENT_LOSS_VOLUME_UOM,
   A.GAS_LIFT_LOSS_VOLUME, BC.UNIT AS GAS_LIFT_LOSS_VOLUME_UOM,
   A.OIL_EVENT_LOSS, BD.UNIT AS OIL_EVENT_LOSS_UOM,
   A.GAS_EVENT_LOSS, BE.UNIT AS GAS_EVENT_LOSS_UOM,
   A.COND_EVENT_LOSS, BF.UNIT AS COND_EVENT_LOSS_UOM,
   A.WATER_EVENT_LOSS, BG.UNIT AS WATER_EVENT_LOSS_UOM,
   A.WATER_INJ_EVENT_LOSS, BH.UNIT AS WATER_INJ_EVENT_LOSS_UOM,
   A.STEAM_INJ_EVENT_LOSS, BI.UNIT AS STEAM_INJ_EVENT_LOSS_UOM,
   A.GAS_INJ_EVENT_LOSS, BJ.UNIT AS GAS_INJ_EVENT_LOSS_UOM,
   A.DILUENT_EVENT_LOSS, BK.UNIT AS DILUENT_EVENT_LOSS_UOM,
   A.GAS_LIFT_EVENT_LOSS, BL.UNIT AS GAS_LIFT_EVENT_LOSS_UOM,
   A.COMMENTS,
   A.CLASS_NAME,
   A.PRODUCTION_DAY,
   A.RECORD_STATUS,
   A.CREATED_BY,
   A.CREATED_DATE,
   A.LAST_UPDATED_BY,
   A.LAST_UPDATED_DATE,
   A.REV_NO,
   A.REV_TEXT,
   A.REV_EVENT,
   A.APPROVAL_STATE,
   A.APPROVAL_BY,
   A.APPROVAL_DATE,
   A.REC_ID
  FROM DV_WELL_DEFERMENT_CHILD A
       LEFT OUTER JOIN UOM B
          ON A.CLASS_NAME = B.CLASS_NAME AND B.ATTRIBUTE_NAME = 'DOWNTIME_DURATION'
       LEFT OUTER JOIN UOM C
          ON A.CLASS_NAME = C.CLASS_NAME AND C.ATTRIBUTE_NAME = 'OIL_POTENTIAL'
       LEFT OUTER JOIN UOM D
          ON A.CLASS_NAME = D.CLASS_NAME AND D.ATTRIBUTE_NAME = 'GAS_POTENTIAL'
       LEFT OUTER JOIN UOM E
          ON A.CLASS_NAME = E.CLASS_NAME AND E.ATTRIBUTE_NAME = 'COND_POTENTIAL'
       LEFT OUTER JOIN UOM F
          ON A.CLASS_NAME = F.CLASS_NAME AND F.ATTRIBUTE_NAME = 'WATER_POTENTIAL'
       LEFT OUTER JOIN UOM G
          ON A.CLASS_NAME = G.CLASS_NAME AND G.ATTRIBUTE_NAME = 'WATER_INJ_POTENTIAL'
       LEFT OUTER JOIN UOM H
          ON A.CLASS_NAME = H.CLASS_NAME AND H.ATTRIBUTE_NAME = 'STEAM_INJ_POTENTIAL'
       LEFT OUTER JOIN UOM I
          ON A.CLASS_NAME = I.CLASS_NAME AND I.ATTRIBUTE_NAME = 'GAS_INJ_POTENTIAL'
       LEFT OUTER JOIN UOM J
          ON A.CLASS_NAME = J.CLASS_NAME AND J.ATTRIBUTE_NAME = 'DILUENT_POTENTIAL'
       LEFT OUTER JOIN UOM K
          ON A.CLASS_NAME = K.CLASS_NAME AND K.ATTRIBUTE_NAME = 'GAS_LIFT_POTENTIAL'
       LEFT OUTER JOIN UOM L
          ON A.CLASS_NAME = L.CLASS_NAME AND L.ATTRIBUTE_NAME = 'OIL_LOSS_RATE'
       LEFT OUTER JOIN UOM M
          ON A.CLASS_NAME = M.CLASS_NAME AND M.ATTRIBUTE_NAME = 'GAS_LOSS_RATE'
       LEFT OUTER JOIN UOM N
          ON A.CLASS_NAME = N.CLASS_NAME AND N.ATTRIBUTE_NAME = 'COND_LOSS_RATE'
       LEFT OUTER JOIN UOM O
          ON A.CLASS_NAME = O.CLASS_NAME AND O.ATTRIBUTE_NAME = 'WATER_LOSS_RATE'
       LEFT OUTER JOIN UOM P
          ON A.CLASS_NAME = P.CLASS_NAME AND P.ATTRIBUTE_NAME = 'WATER_INJ_LOSS_RATE'
       LEFT OUTER JOIN UOM Q
          ON A.CLASS_NAME = Q.CLASS_NAME AND Q.ATTRIBUTE_NAME = 'STEAM_INJ_LOSS_RATE'
       LEFT OUTER JOIN UOM R
          ON A.CLASS_NAME = R.CLASS_NAME AND R.ATTRIBUTE_NAME = 'GAS_INJ_LOSS_RATE'
       LEFT OUTER JOIN UOM S
          ON A.CLASS_NAME = S.CLASS_NAME AND S.ATTRIBUTE_NAME = 'DILUENT_LOSS_RATE'
       LEFT OUTER JOIN UOM T
          ON A.CLASS_NAME = T.CLASS_NAME AND T.ATTRIBUTE_NAME = 'GAS_LIFT_LOSS_RATE'
       LEFT OUTER JOIN UOM U
          ON A.CLASS_NAME = U.CLASS_NAME AND U.ATTRIBUTE_NAME = 'OIL_LOSS_VOLUME'
       LEFT OUTER JOIN UOM V
          ON A.CLASS_NAME = V.CLASS_NAME AND V.ATTRIBUTE_NAME = 'GAS_LOSS_VOLUME'
       LEFT OUTER JOIN UOM W
          ON A.CLASS_NAME = W.CLASS_NAME AND W.ATTRIBUTE_NAME = 'COND_LOSS_VOLUME'
       LEFT OUTER JOIN UOM X
          ON A.CLASS_NAME = X.CLASS_NAME AND X.ATTRIBUTE_NAME = 'WATER_LOSS_VOLUME'
       LEFT OUTER JOIN UOM Y
          ON A.CLASS_NAME = Y.CLASS_NAME AND Y.ATTRIBUTE_NAME = 'WATER_INJ_LOSS_VOLUME'
       LEFT OUTER JOIN UOM Z
          ON A.CLASS_NAME = Z.CLASS_NAME AND Z.ATTRIBUTE_NAME = 'STEAM_INJ_LOSS_VOLUME'
       LEFT OUTER JOIN UOM BA
          ON A.CLASS_NAME = BA.CLASS_NAME AND BA.ATTRIBUTE_NAME = 'GAS_INJ_LOSS_VOLUME'
       LEFT OUTER JOIN UOM BB
          ON A.CLASS_NAME = BB.CLASS_NAME AND BB.ATTRIBUTE_NAME = 'DILUENT_LOSS_VOLUME'
       LEFT OUTER JOIN UOM BC
          ON A.CLASS_NAME = BC.CLASS_NAME AND BC.ATTRIBUTE_NAME = 'GAS_LIFT_LOSS_VOLUME'
       LEFT OUTER JOIN UOM BD
          ON A.CLASS_NAME = BD.CLASS_NAME AND BD.ATTRIBUTE_NAME = 'OIL_EVENT_LOSS'
       LEFT OUTER JOIN UOM BE
          ON A.CLASS_NAME = BE.CLASS_NAME AND BE.ATTRIBUTE_NAME = 'GAS_EVENT_LOSS'
       LEFT OUTER JOIN UOM BF
          ON A.CLASS_NAME = BF.CLASS_NAME AND BF.ATTRIBUTE_NAME = 'COND_EVENT_LOSS'
       LEFT OUTER JOIN UOM BG
          ON A.CLASS_NAME = BG.CLASS_NAME AND BG.ATTRIBUTE_NAME = 'WATER_EVENT_LOSS'
       LEFT OUTER JOIN UOM BH
          ON A.CLASS_NAME = BH.CLASS_NAME AND BH.ATTRIBUTE_NAME = 'WATER_INJ_EVENT_LOSS'
       LEFT OUTER JOIN UOM BI
          ON A.CLASS_NAME = BI.CLASS_NAME AND BI.ATTRIBUTE_NAME = 'STEAM_INJ_EVENT_LOSS'
       LEFT OUTER JOIN UOM BJ
          ON A.CLASS_NAME = BJ.CLASS_NAME AND BJ.ATTRIBUTE_NAME = 'GAS_INJ_EVENT_LOSS'
       LEFT OUTER JOIN UOM BK
          ON A.CLASS_NAME = BK.CLASS_NAME AND BK.ATTRIBUTE_NAME = 'DILUENT_EVENT_LOSS'
       LEFT OUTER JOIN UOM BL
          ON A.CLASS_NAME = BL.CLASS_NAME AND BL.ATTRIBUTE_NAME = 'GAS_LIFT_EVENT_LOSS';


COMMENT ON MATERIALIZED VIEW ECKERNEL_USA.MV_WELL_DEFERMENT_CHILD IS 'snapshot table for snapshot ECKERNEL_USA.MV_WELL_DEFERMENT_CHILD';

CREATE OR REPLACE SYNONYM DASHBOARD.MV_WELL_DEFERMENT_CHILD FOR ECKERNEL_USA.MV_WELL_DEFERMENT_CHILD;

CREATE OR REPLACE SYNONYM TRANSFER_USA.MV_WELL_DEFERMENT_CHILD FOR ECKERNEL_USA.MV_WELL_DEFERMENT_CHILD;

CREATE OR REPLACE SYNONYM REPORTING_USA.MV_WELL_DEFERMENT_CHILD FOR ECKERNEL_USA.MV_WELL_DEFERMENT_CHILD;

CREATE OR REPLACE SYNONYM ENERGYX_USA.MV_WELL_DEFERMENT_CHILD FOR ECKERNEL_USA.MV_WELL_DEFERMENT_CHILD;

CREATE OR REPLACE SYNONYM EMECCT.MV_WELL_DEFERMENT_CHILD FOR ECKERNEL_USA.MV_WELL_DEFERMENT_CHILD;

CREATE UNIQUE INDEX ECKERNEL_USA.MV_WELL_DEFERMENT_CHILD_PK ON ECKERNEL_USA.MV_WELL_DEFERMENT_CHILD
(EVENT_NO)
LOGGING
TABLESPACE DATA01
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;



GRANT SELECT, READ ON ECKERNEL_USA.MV_WELL_DEFERMENT_CHILD TO APP_READ_ROLE_USA;

GRANT DELETE, INSERT, SELECT, UPDATE ON ECKERNEL_USA.MV_WELL_DEFERMENT_CHILD TO APP_WRITE_ROLE_USA;

GRANT SELECT ON ECKERNEL_USA.MV_WELL_DEFERMENT_CHILD TO INTERFACE_READ_ROLE;
