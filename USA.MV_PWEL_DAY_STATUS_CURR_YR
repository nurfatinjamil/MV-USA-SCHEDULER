BEGIN
    EXECUTE IMMEDIATE 'DROP MATERIALIZED VIEW ECKERNEL_USA.MV_PWEL_DAY_STATUS_CURR_YR';
EXCEPTION
    WHEN OTHERS THEN NULL;
END;
CREATE MATERIALIZED VIEW ECKERNEL_USA.MV_PWEL_DAY_STATUS_CURR_YR 
(
MV_RFRSH_DATE,
CLASS_NAME,
OBJECT_ID,       
OBJECT_CODE,
DAYTIME,
WELL_TYPE,       
WELL_STATUS,       
ON_STREAM_HRS,       
AVG_CHOKE_SIZE,       
CHOKE_UOM,       
AVG_WH_PRESS,       
AVG_WH_TEMP,       
AVG_GL_RATE,    
AVG_GL_PRESS,    
ANNULUS_PRESS_SURF,       
GOR,      
AVG_GAS_RATE,
THEOR_OIL_VOL,
THEOR_GAS_VOL,       
THEOR_COND_VOL,
THEOR_WATER_VOL,       
THEOR_GL_VOL,
ALLOC_OIL_VOL,
ALLOC_COND_VOL,
ALLOC_GAS_VOL,
ALLOC_WATER_VOL,
ALLOC_GL_VOL,
DATA_CLASS_NAME,
OBJECT_ID2,
RECORD_STATUS,
CREATED_BY,
CREATED_DATE,
LAST_UPDATED_BY,
LAST_UPDATED_DATE,       
REV_NO,       
REV_TEXT,       
REV_EVENT,       
APPROVAL_STATE,       
APPROVAL_BY,       
APPROVAL_DATE,       
REC_ID
)
TABLESPACE DATA01
PCTUSED    0
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOCACHE
NOLOGGING
NOCOMPRESS
NOPARALLEL
BUILD IMMEDIATE
REFRESH FORCE ON DEMAND
WITH PRIMARY KEY
AS 
/* Formatted on 27/Mar/23 11:07:41 AM (QP5 v5.227.12220.39724) */
SELECT SYSDATE AS MV_RFRSH_DATE,
CLASS_NAME,
OBJECT_ID,       
OBJECT_CODE,
DAYTIME,
WELL_TYPE,       
WELL_STATUS,       
ON_STREAM_HRS,       
AVG_CHOKE_SIZE,       
CHOKE_UOM,       
AVG_WH_PRESS,       
AVG_WH_TEMP,       
AVG_GL_RATE,    
AVG_GL_PRESS,    
ANNULUS_PRESS_SURF,       
GOR,      
AVG_GAS_RATE,
THEOR_OIL_VOL,
THEOR_GAS_VOL,       
THEOR_COND_VOL,
THEOR_WATER_VOL,       
THEOR_GL_VOL,
ALLOC_OIL_VOL,
ALLOC_COND_VOL,
ALLOC_GAS_VOL,
ALLOC_WATER_VOL,
ALLOC_GL_VOL,
DATA_CLASS_NAME,
OBJECT_ID2,
RECORD_STATUS,
CREATED_BY,
CREATED_DATE,
LAST_UPDATED_BY,
LAST_UPDATED_DATE,       
REV_NO,       
REV_TEXT,       
REV_EVENT,       
APPROVAL_STATE,       
APPROVAL_BY,       
APPROVAL_DATE,       
REC_ID
  FROM DV_PWEL_DAY_STATUS
 WHERE DAYTIME BETWEEN TRUNC (SYSDATE, 'YEAR')
                   AND LAST_DAY (ADD_MONTHS (TRUNC (SYSDATE, 'MONTH'), -1));


COMMENT ON MATERIALIZED VIEW ECKERNEL_USA.MV_PWEL_DAY_STATUS_CURR_YR IS 'snapshot table for snapshot ECKERNEL_USA.MV_PWEL_DAY_STATUS_CURR_YR';

CREATE OR REPLACE SYNONYM DASHBOARD.MV_PWEL_DAY_STATUS_CURR_YR FOR ECKERNEL_USA.MV_PWEL_DAY_STATUS_CURR_YR;

CREATE OR REPLACE SYNONYM TRANSFER_USA.MV_PWEL_DAY_STATUS_CURR_YR FOR ECKERNEL_USA.MV_PWEL_DAY_STATUS_CURR_YR;

CREATE OR REPLACE SYNONYM REPORTING_USA.MV_PWEL_DAY_STATUS_CURR_YR FOR ECKERNEL_USA.MV_PWEL_DAY_STATUS_CURR_YR;

CREATE OR REPLACE SYNONYM ENERGYX_USA.MV_PWEL_DAY_STATUS_CURR_YR FOR ECKERNEL_USA.MV_PWEL_DAY_STATUS_CURR_YR;

CREATE OR REPLACE SYNONYM EMECCT.MV_PWEL_DAY_STATUS_CURR_YR FOR ECKERNEL_USA.MV_PWEL_DAY_STATUS_CURR_YR;

CREATE UNIQUE INDEX ECKERNEL_USA.PK_MV_PWEL_DAY_STATUS_CURR_YR ON ECKERNEL_USA.MV_PWEL_DAY_STATUS_CURR_YR
(OBJECT_ID, DAYTIME)
LOGGING
TABLESPACE DATA01
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;
GRANT READ ON ECKERNEL_USA.PK_MV_PWEL_DAY_STATUS_CURR_YR TO APP_READ_ROLE_USA;

GRANT DELETE, INSERT, SELECT, UPDATE ON ECKERNEL_USA.PK_MV_PWEL_DAY_STATUS_CURR_YR TO APP_WRITE_ROLE_USA;