BEGIN
    EXECUTE IMMEDIATE 'DROP MATERIALIZED VIEW ECKERNEL_USA.MV_STRM_DAY_STREAM_MEAS_GAS';
EXCEPTION
    WHEN OTHERS THEN NULL;
END;
CREATE MATERIALIZED VIEW ECKERNEL_USA.MV_STRM_DAY_STREAM_MEAS_GAS 
(MV_RFRSH_DATE,CLASS_NAME,OBJECT_ID,OBJECT_CODE,PPA_OVRD,
STREAM_NAME,DAYTIME,SORT_ORDER,GRS_VOL_GAS,GRS_VOL_GAS_UOM,
ON_STREAM_HRS,ON_STREAM_HRS_UOM,YDAY_GRS_VOL,YDAY_GRS_VOL_UOM,
MTH_AVG_GRS_VOL,MTH_AVG_GRS_VOL_UOM,DEW_POINT,DEW_POINT_UOM,
RECORD_STATUS,CREATED_BY,CREATED_DATE,LAST_UPDATED_BY,
LAST_UPDATED_DATE,REV_NO,REV_TEXT,REV_EVENT,APPROVAL_STATE,
APPROVAL_BY,APPROVAL_DATE,REC_ID)
TABLESPACE DATA01
PCTUSED    0
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOCACHE
NOLOGGING
NOCOMPRESS
NOPARALLEL
BUILD IMMEDIATE
REFRESH FORCE ON DEMAND
WITH PRIMARY KEY
AS 
/* Formatted on 24-Mar-23 3:05:41 PM (QP5 v5.227.12220.39724) */
WITH UOM
     AS (SELECT CLASS_NAME, ATTRIBUTE_NAME, UNIT
           FROM Z_UOM
          WHERE ATTRIBUTE_NAME IN
                   ('GRS_VOL_GAS',
                    'ON_STREAM_HRS',
                    'YDAY_GRS_VOL',
                    'MTH_AVG_GRS_VOL',
                    'DEW_POINT'))
SELECT SYSDATE AS MV_RFRSH_DATE,
       A.CLASS_NAME,
       A.OBJECT_ID,
       A.OBJECT_CODE,
       A.PPA_OVRD,
       A.STREAM_NAME,
       A.DAYTIME,
       A.SORT_ORDER,
       A.GRS_VOL_GAS,
       B.UNIT AS GRS_VOL_GAS_UOM,
       A.ON_STREAM_HRS,
       C.UNIT AS ON_STREAM_HRS_UOM,
       A.YDAY_GRS_VOL,
       D.UNIT AS YDAY_GRS_VOL_UOM,
       A.MTH_AVG_GRS_VOL,
       E.UNIT AS MTH_AVG_GRS_VOL_UOM,
       A.DEW_POINT,
       F.UNIT AS DEW_POINT_UOM,
       A.RECORD_STATUS,
       A.CREATED_BY,
       A.CREATED_DATE,
       A.LAST_UPDATED_BY,
       A.LAST_UPDATED_DATE,
       A.REV_NO,
       A.REV_TEXT,
       A.REV_EVENT,
       A.APPROVAL_STATE,
       A.APPROVAL_BY,
       A.APPROVAL_DATE,
       A.REC_ID
  FROM DV_STRM_DAY_STREAM_MEAS_GAS A
       LEFT OUTER JOIN UOM B
          ON A.CLASS_NAME = B.CLASS_NAME AND B.ATTRIBUTE_NAME = 'GRS_VOL_GAS'
       LEFT OUTER JOIN
       UOM C
          ON     A.CLASS_NAME = C.CLASS_NAME
             AND C.ATTRIBUTE_NAME = 'ON_STREAM_HRS'
       LEFT OUTER JOIN
       UOM D
          ON     A.CLASS_NAME = D.CLASS_NAME
             AND D.ATTRIBUTE_NAME = 'YDAY_GRS_VOL'
       LEFT OUTER JOIN
       UOM E
          ON     A.CLASS_NAME = E.CLASS_NAME
             AND E.ATTRIBUTE_NAME = 'MTH_AVG_GRS_VOL'
       LEFT OUTER JOIN UOM F
          ON A.CLASS_NAME = F.CLASS_NAME AND F.ATTRIBUTE_NAME = 'DEW_POINT';


COMMENT ON MATERIALIZED VIEW ECKERNEL_USA.MV_STRM_DAY_STREAM_MEAS_GAS IS 'snapshot table for snapshot ECKERNEL_USA.MV_STRM_DAY_STREAM_MEAS_GAS';

CREATE OR REPLACE SYNONYM ENERGYX_USA.MV_STRM_DAY_STREAM_MEAS_GAS FOR ECKERNEL_USA.MV_STRM_DAY_STREAM_MEAS_GAS;

CREATE OR REPLACE SYNONYM EMECCT.MV_STRM_DAY_STREAM_MEAS_GAS FOR ECKERNEL_USA.MV_STRM_DAY_STREAM_MEAS_GAS;

CREATE OR REPLACE SYNONYM DASHBOARD.MV_STRM_DAY_STREAM_MEAS_GAS FOR ECKERNEL_USA.MV_STRM_DAY_STREAM_MEAS_GAS;

CREATE UNIQUE INDEX ECKERNEL_USA.MV_STRM_DAY_STREAM_MEAS_GAS_PK ON ECKERNEL_USA.MV_STRM_DAY_STREAM_MEAS_GAS
(OBJECT_ID, DAYTIME)
LOGGING
TABLESPACE DATA01
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;

GRANT READ ON ECKERNEL_USA.MV_STRM_DAY_STREAM_MEAS_GAS TO APP_READ_ROLE_USA;

GRANT DELETE, INSERT, SELECT, UPDATE ON ECKERNEL_USA.MV_STRM_DAY_STREAM_MEAS_GAS TO APP_WRITE_ROLE_USA;

GRANT READ ON ECKERNEL_USA.MV_STRM_DAY_STREAM_MEAS_GAS TO INTERFACE_READ_ROLE;