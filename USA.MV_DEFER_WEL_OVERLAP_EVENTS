BEGIN
    EXECUTE IMMEDIATE 'DROP MATERIALIZED VIEW ECKERNEL_USA.MV_DEFER_WEL_OVERLAP_EVENTS';
EXCEPTION
    WHEN OTHERS THEN NULL;
END;
CREATE MATERIALIZED VIEW ECKERNEL_USA.MV_DEFER_WEL_OVERLAP_EVENTS 
(
   MV_RFRSH_DATE,
   OBJECT_ID,
   OBJECT_CODE,
   OBJECT_TYPE,
   CLASS_NAME,
   DEFERMENT_TYPE,
   EVENT_NO,
   DAYTIME,
   END_DATE,
   EVENT_TYPE,
   PARENT_OBJECT_TYPE,
   PARENT_OBJECT_ID,
   PARENT_DAYTIME,
   OIL_EVENT_LOSS, OIL_EVENT_LOSS_UOM,
   GAS_EVENT_LOSS, GAS_EVENT_LOSS_UOM,
   COND_EVENT_LOSS, COND_EVENT_LOSS_UOM,
   WATER_EVENT_LOSS, WATER_EVENT_LOSS_UOM,
   WATER_INJ_EVENT_LOSS, WATER_INJ_EVENT_LOSS_UOM,
   STEAM_INJ_EVENT_LOSS, STEAM_INJ_EVENT_LOSS_UOM,
   GAS_INJ_EVENT_LOSS, GAS_INJ_EVENT_LOSS_UOM,
   DILUENT_EVENT_LOSS, DILUENT_EVENT_LOSS_UOM,
   GAS_LIFT_EVENT_LOSS, GAS_LIFT_EVENT_LOSS_UOM,
   RECORD_STATUS,
   CREATED_BY,
   CREATED_DATE,
   LAST_UPDATED_BY,
   LAST_UPDATED_DATE,
   REV_NO,
   REV_TEXT
   )
TABLESPACE DATA01
PCTUSED    0
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOCACHE
NOLOGGING
NOCOMPRESS
NOPARALLEL
BUILD DEFERRED
REFRESH FORCE ON DEMAND
WITH PRIMARY KEY
AS 
/* Formatted on 06-Apr-23 11:18:45 AM (QP5 v5.227.12220.39724) */
WITH UOM
     AS (SELECT CLASS_NAME, ATTRIBUTE_NAME, UNIT
           FROM Z_UOM
          WHERE ATTRIBUTE_NAME IN
                   ('OIL_EVENT_LOSS',
                    'GAS_EVENT_LOSS',
                    'COND_EVENT_LOSS',
                    'WATER_EVENT_LOSS',
                    'WATER_INJ_EVENT_LOSS',
                    'STEAM_INJ_EVENT_LOSS',
                    'GAS_INJ_EVENT_LOSS',
                    'DILUENT_EVENT_LOSS',
                    'GAS_LIFT_EVENT_LOSS'))
SELECT SYSDATE AS MV_RFRSH_DATE,
   A.OBJECT_ID,
   A.OBJECT_CODE,
   A.OBJECT_TYPE,
   A.CLASS_NAME,
   A.DEFERMENT_TYPE,
   A.EVENT_NO,
   A.DAYTIME,
   A.END_DATE,
   A.EVENT_TYPE,
   A.PARENT_OBJECT_TYPE,
   A.PARENT_OBJECT_ID,
   A.PARENT_DAYTIME,
   A.OIL_EVENT_LOSS, B.UNIT AS OIL_EVENT_LOSS_UOM,
   A.GAS_EVENT_LOSS, C.UNIT AS GAS_EVENT_LOSS_UOM,
   A.COND_EVENT_LOSS, D.UNIT AS COND_EVENT_LOSS_UOM,
   A.WATER_EVENT_LOSS, E.UNIT AS WATER_EVENT_LOSS_UOM,
   A.WATER_INJ_EVENT_LOSS, F.UNIT AS WATER_INJ_EVENT_LOSS_UOM,
   A.STEAM_INJ_EVENT_LOSS, G.UNIT AS STEAM_INJ_EVENT_LOSS_UOM,
   A.GAS_INJ_EVENT_LOSS, H.UNIT AS GAS_INJ_EVENT_LOSS_UOM,
   A.DILUENT_EVENT_LOSS, I.UNIT AS DILUENT_EVENT_LOSS_UOM,
   A.GAS_LIFT_EVENT_LOSS, J.UNIT AS GAS_LIFT_EVENT_LOSS_UOM,
   A.RECORD_STATUS,
   A.CREATED_BY,
   A.CREATED_DATE,
   A.LAST_UPDATED_BY,
   A.LAST_UPDATED_DATE,
   A.REV_NO,
   A.REV_TEXT
  FROM DV_DEFER_WEL_OVERLAP_EVENTS A
       LEFT OUTER JOIN UOM B
          ON A.CLASS_NAME = B.CLASS_NAME AND B.ATTRIBUTE_NAME = 'OIL_EVENT_LOSS'
       LEFT OUTER JOIN UOM C
          ON A.CLASS_NAME = C.CLASS_NAME AND C.ATTRIBUTE_NAME = 'GAS_EVENT_LOSS'
       LEFT OUTER JOIN UOM D
          ON A.CLASS_NAME = D.CLASS_NAME AND D.ATTRIBUTE_NAME = 'COND_EVENT_LOSS'
       LEFT OUTER JOIN UOM E
          ON A.CLASS_NAME = E.CLASS_NAME AND E.ATTRIBUTE_NAME = 'WATER_EVENT_LOSS'
       LEFT OUTER JOIN UOM F
          ON A.CLASS_NAME = F.CLASS_NAME AND F.ATTRIBUTE_NAME = 'WATER_INJ_EVENT_LOSS'
       LEFT OUTER JOIN UOM G
          ON A.CLASS_NAME = G.CLASS_NAME AND G.ATTRIBUTE_NAME = 'STEAM_INJ_EVENT_LOSS'
       LEFT OUTER JOIN UOM H
          ON A.CLASS_NAME = H.CLASS_NAME AND H.ATTRIBUTE_NAME = 'GAS_INJ_EVENT_LOSS'
       LEFT OUTER JOIN UOM I
          ON A.CLASS_NAME = I.CLASS_NAME AND I.ATTRIBUTE_NAME = 'DILUENT_EVENT_LOSS'
       LEFT OUTER JOIN UOM J
          ON A.CLASS_NAME = J.CLASS_NAME AND J.ATTRIBUTE_NAME = 'GAS_LIFT_EVENT_LOSS';


COMMENT ON MATERIALIZED VIEW ECKERNEL_USA.MV_DEFER_WEL_OVERLAP_EVENTS IS 'snapshot table for snapshot ECKERNEL_USA.MV_DEFER_WEL_OVERLAP_EVENTS';

CREATE OR REPLACE SYNONYM ENERGYX_USA.MV_DEFER_WEL_OVERLAP_EVENTS FOR ECKERNEL_USA.MV_DEFER_WEL_OVERLAP_EVENTS;

CREATE OR REPLACE SYNONYM EMECCT.MV_DEFER_WEL_OVERLAP_EVENTS FOR ECKERNEL_USA.MV_DEFER_WEL_OVERLAP_EVENTS;

CREATE OR REPLACE SYNONYM DASHBOARD.MV_DEFER_WEL_OVERLAP_EVENTS FOR ECKERNEL_USA.MV_DEFER_WEL_OVERLAP_EVENTS;

CREATE UNIQUE INDEX ECKERNEL_USA.MV_DEFER_WEL_OVERLAP_EVENTS_PK ON ECKERNEL_USA.MV_DEFER_WEL_OVERLAP_EVENTS
(OBJECT_ID, DAYTIME, EVENT_NO)
LOGGING
TABLESPACE DATA01
PCTFREE    10
INITRANS   2
MAXTRANS   255
STORAGE    (
            INITIAL          64K
            NEXT             1M
            MINEXTENTS       1
            MAXEXTENTS       UNLIMITED
            PCTINCREASE      0
            BUFFER_POOL      DEFAULT
            FLASH_CACHE      DEFAULT
            CELL_FLASH_CACHE DEFAULT
           )
NOPARALLEL;



GRANT READ ON ECKERNEL_USA.MV_DEFER_WEL_OVERLAP_EVENTS TO APP_READ_ROLE_USA;

GRANT DELETE, INSERT, SELECT, UPDATE ON ECKERNEL_USA.MV_DEFER_WEL_OVERLAP_EVENTS TO APP_WRITE_ROLE_USA;

GRANT READ ON ECKERNEL_USA.MV_DEFER_WEL_OVERLAP_EVENTS TO KEPLER_READ_ROLE;
